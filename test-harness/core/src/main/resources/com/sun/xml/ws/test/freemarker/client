#!/bin/bash -ex
# service id: ${serviceId}
# stage: ${stage}
if [ "$G_STATUS" = "1" ]; then
    return 1
fi;

if [ "$skipTests" != "true" ]; then

    export CTX=${serviceId}:${stage}-client

    . shared

    prolog $CTX

    log "Running ${testName}"

    # compile generated client sources
    SRC_FILES=
    if [ -d "client-source" ]; then
        SRC_FILES=`find client-source -name '*.java'`
        r javac -cp ${classpath} -d client-classes $SRC_FILES
    fi

    # compile generated bash.Client#.java
    r javac -cp ${classpath} -d client-classes \
         bsh/Client${stage}.java

    # actual running client
    runjava ${classpath} bsh.Client${stage}
    #r sleep 1
fi;